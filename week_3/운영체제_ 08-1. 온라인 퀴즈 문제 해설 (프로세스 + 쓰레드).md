
운영체제의 핵심 개념인 **프로세스와 스레드**의 동작 원리를 실제 코드 예제를 통해 명확하게 이해할 수 있는 해설입니다. fork()와 pthread_create(), wait() 등의 함수가 어떻게 상호작용하며 **컨텍스트 스위칭**을 유발하고 변수 값에 영향을 미치는지 단계별로 추적합니다. 복잡하게 얽힌 코드 흐름 속에서 각 함수 호출이 프로그램의 최종 출력에 어떤 영향을 주는지 **구체적인 값의 변화**를 따라가며 학습할 수 있습니다. 이론으로만 접했던 운영체제 개념이 실제 프로그램에서 어떻게 구현되고 동작하는지 궁금하다면 이 해설이 **실질적인 문제 해결 능력**을 키우는 데 큰 도움이 될 것입니다.
## 1. 온라인 퀴즈 문제 해설: 프로세스 + 쓰레드 


### 1.1. 초기 프로세스 생성 및 변수 상태 
![image]()
1. **초기 변수 설정**: x의 초기값은 <mark>10</mark>으로 설정된다. 

2. fork() 호출 (P1 생성):
  1. pid1 = fork()가 호출되어 **P1 프로세스**가 생성된다. 
  2. 이때 P1은 x의 값 <mark>10</mark>을 복사하여 갖게 된다. 
  3. fork() 호출 후, 부모 프로세스(원래 프로세스)는 pid1이 0보다 큰 값을 가지며, 자식 프로세스(P1)는 pid1이 <mark>0</mark>이 된다. 

3. **부모 프로세스의 **wait() 호출:
  1. 부모 프로세스는 wait() 함수를 호출하여 자식 프로세스(P1)가 종료될 때까지 **대기 상태**에 들어간다. 
  2. 이로 인해 **컨텍스트 스위칭**이 발생하여 P1 프로세스가 실행될 기회를 얻는다. 


### 1.2. P1 프로세스의 실행 및 쓰레드 생성 
![image]()
1. **P1 프로세스 실행**: 컨텍스트 스위칭 후 P1 프로세스가 실행되며, pid1이 <mark>0</mark>인 조건을 만족하여 해당 코드 블록으로 진입한다. 

2. pthread_create() 호출 (Runner 쓰레드 생성):
  1. P1 프로세스 내에서 pthread_create() 함수가 호출되어 **Runner 쓰레드**가 생성된다. 
  2. pthread_create() 호출 후, P1 프로세스는 Runner 쓰레드가 작업을 완료하고 돌아올 때까지 **기다린다**. 

3. **Runner 쓰레드 실행**:
  1. Runner 쓰레드는 x의 값에 <mark>2</mark>를 더한다. 
  2. P1의 x 값은 <mark>10</mark>이었으므로, Runner 쓰레드 내에서 x는 <mark>12</mark>가 된다. 

4. fork() 호출 (P2 생성):
  1. Runner 쓰레드 내에서 fork()가 호출되어 **P2 프로세스**가 생성된다. 
  2. P2는 Runner 쓰레드의 현재 x 값인 <mark>12</mark>를 복사하여 갖게 된다. 
  3. fork() 호출 후, Runner 쓰레드는 부모 프로세스가 되고, P2는 자식 프로세스가 된다. 

5. **Runner 쓰레드의 **wait() 호출:
  1. Runner 쓰레드는 pid_fork가 0보다 큰 경우(부모 프로세스) wait()를 호출하여 P2가 종료될 때까지 **대기**한다. 
  2. 이로 인해 P2 프로세스가 실행될 기회를 얻는다. 

6. **P2 프로세스 실행 및 출력**:
  1. P2 프로세스는 pid_fork가 <mark>0</mark>인 조건을 만족하여 해당 코드 블록으로 진입한다. 
  2. printf() 함수를 통해 P2의 x 값인 <mark>12</mark>를 출력한다. 
  3. P2는 더 이상 실행할 코드가 없으므로 **리턴(종료)**한다. 

7. **Runner 쓰레드로 복귀**: P2가 종료되면 wait() 상태에 있던 Runner 쓰레드가 다시 실행된다. 


### 1.3. Runner 쓰레드 및 P1 프로세스의 최종 실행 
![image]()
1. **Runner 쓰레드의 **x 값 변경:
  1. Runner 쓰레드는 x에 <mark>10</mark>을 더한다. 
  2. Runner 쓰레드의 x 값은 <mark>12</mark>였으므로, <mark>10</mark>을 더하여 <mark>22</mark>가 된다. 

2. **Runner 쓰레드의 출력**:
  1. printf() 함수를 통해 Runner 쓰레드의 x 값인 <mark>22</mark>를 출력한다. 
  2. Runner 쓰레드는 더 이상 실행할 코드가 없으므로 **리턴(종료)**한다. 

3. **P1 프로세스로 복귀**: Runner 쓰레드가 종료되면 wait() 상태에 있던 P1 프로세스가 다시 실행된다. 

4. **P1 프로세스의 출력**:
  1. P1 프로세스는 printf() 함수를 통해 자신의 x 값인 <mark>10</mark>을 출력한다. 
  2. P1 프로세스는 더 이상 실행할 코드가 없으므로 **리턴(종료)**한다. 

5. **최종 결과**: 모든 프로세스와 쓰레드의 실행이 완료되면, 출력 순서는 <mark>12</mark>, <mark>22</mark>, <mark>10</mark>이 된다. 

