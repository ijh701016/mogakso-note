
## π“ μ² ν•™μλ“¤μ μ €λ… μ‹μ‚¬ λ¬Έμ λ¥Ό μλ°”(Java)λ΅ κµ¬ν„ν•  λ• μ‚¬μ©λλ” μ£Όμ” κΈ°λ¥μ€ λ¬΄μ—‡μΈκ°€μ”?
μλ°”μ—μ„λ” java.util.concurrent.locks ν¨ν‚¤μ§€μ Condition λ³€μμ™€ ReentrantLockμ„ μ‚¬μ©ν•μ—¬ μ² ν•™μλ“¤μ μ €λ… μ‹μ‚¬ λ¬Έμ λ¥Ό ν•΄κ²°ν•©λ‹λ‹¤.
##### π’΅ ReentrantLockμ 'μ¬μ§„μ… κ°€λ¥'μ΄λΌλ” μ©μ–΄λ” λ¬΄μ—‡μ„ μλ―Έν•λ‚μ”?
μ¬μ§„μ… κ°€λ¥μ€ CPUμ—μ„ μ»¨ν…μ¤νΈ μ¤μ„μΉκ°€ λ°μƒν•μ—¬ ν”„λ΅μ„Έμ¤κ°€ λ λ”” νλ΅ μ΄λ™ν–λ‹¤κ°€ λ‹¤μ‹ CPUλ΅ λμ•„μ™€ μ‹¤ν–‰λλ” κ²ƒμ„ μλ―Έν•©λ‹λ‹¤.


μ΄ κ°•μλ” **'μ² ν•™μλ“¤μ μ €λ… μ‹μ‚¬ λ¬Έμ '**λ¥Ό μλ°”(Java) μ–Έμ–΄λ΅ κµ¬ν„ν•λ” κ³Όμ •μ„ μƒμ„Έν μ„¤λ…ν•©λ‹λ‹¤. μ΄μμ²΄μ μ—μ„ **λ™κΈ°ν™” λ¬Έμ  ν•΄κ²°**μ ν•µμ‹¬μΈ **λ¨λ‹ν„° κ°λ…**μ„ μλ°”μ ReentrantLockκ³Ό Condition λ³€μλ¥Ό ν™μ©ν•μ—¬ μ–΄λ–»κ² μ μ©ν•λ”μ§€ κµ¬μ²΄μ μΈ μ½”λ“μ™€ ν•¨κ» λ°°μΈ μ μμµλ‹λ‹¤. νΉν, waitμ™€ notify λ€μ‹  awaitμ™€ signalμ„ μ‚¬μ©ν•λ” **μ»¨λ””μ… λ³€μμ μ‘λ™ λ°©μ‹**μ„ λ…ν™•ν μ΄ν•΄ν•κ³ , μ‹¤μ  λ©€ν‹°μ¤λ λ“ ν™κ²½μ—μ„ λ°μƒν•  μ μλ” **κµμ°© μƒνƒ(Deadlock) λ°©μ§€**λ¥Ό μ„ν• μ‹¤μ©μ μΈ ν•΄κ²°μ±…μ„ μ–»μ„ μ μμµλ‹λ‹¤. λ³µμ΅ν• λ™μ‹μ„± ν”„λ΅κ·Έλλ° λ¬Έμ λ¥Ό μλ°”λ΅ ν•΄κ²°ν•λ” **μ‹¤μ§μ μΈ λ…Έν•μ°**λ¥Ό μ–»κ³  μ‹¶μ€ κ°λ°μμ—κ² κ°•λ ¥ν μ¶”μ²ν•©λ‹λ‹¤.
## 1. μ² ν•™μλ“¤μ μ €λ… μ‹μ‚¬ λ¬Έμ : Java λ²„μ „ κµ¬ν„ κ°μ” 
![image]()
1. **κ°•μ μ†κ° λ° μλ£ μ•λ‚΄** 
  1. λ³Έ κ°•μλ” 'μ² ν•™μλ“¤μ μ €λ… μ‹μ‚¬ λ¬Έμ 'λ¥Ό μλ°”(Java) λ²„μ „μΌλ΅ κµ¬ν„ν•λ” λ‚΄μ©μ„ λ‹¤λ£¬λ‹¤. 
  2. κ°•μ μλ£λ” λ‹¤μ‹ μ—…λ°μ΄νΈλμ—μΌλ―€λ΅, μ΄μ „μ— λ‹¤μ΄λ΅λ“ν• κ²½μ° μƒλ΅ λ‹¤μ΄λ΅λ“ν•΄μ•Ό ν•λ‹¤. 

2. **Javaλ¥Ό ν™μ©ν• λ¬Έμ  ν•΄κ²°** 
  1. μ΄μ „ κ°•μμ—μ„ C++λ΅ λ¬Έμ λ¥Ό ν•΄κ²°ν–μΌλ©°, μ΄λ²μ—λ” Javaλ΅ ν•΄κ²°ν•λ” λ°©λ²•μ„ λ‹¤λ£¬λ‹¤. 


## 2. Java λ™κΈ°ν™” λ©”μ»¤λ‹μ¦: ReentrantLockκ³Ό Condition Variable 
![image]()
1. **Java λ™μ‹μ„± μ ν‹Έλ¦¬ν‹° ν™μ©** 
  1. Javaμ java.util.concurrent.locks ν¨ν‚¤μ§€μ— μλ” Condition λ³€μμ™€ ReentrantLockμ„ μ‚¬μ©ν•λ‹¤. 

2. **ReentrantLockμ κ°λ…** 
  1. ReentrantLockμ€ 'μ¬μ§„μ… κ°€λ¥ν• λ½(lock)'μ„ μλ―Έν•λ‹¤. 
  2. **μ¬μ§„μ… κ°€λ¥μ„±**: CPUμ—μ„ μ»¨ν…μ¤νΈ μ¤μ„μΉκ°€ λ°μƒν•μ—¬ μ¤λ λ“κ°€ λ λ”” ν(Ready Queue)λ΅ κ°”λ‹¤κ°€ λ‹¤μ‹ CPUμ— μ§„μ…ν•λ” κ²ƒμ„ μλ―Έν•λ‹¤. 
  3. ReentrantLockμ€ μ΄λ¬ν• μ¬μ§„μ…μ„ κ°€λ¥ν•κ² ν•΄μ£Όλ” λ½(lock)μ΄λ‹¤. 


## 3. μ² ν•™μλ“¤μ μ €λ… μ‹μ‚¬ λ¬Έμ  Java κµ¬ν„ κµ¬μ΅° 
![image]()
1. **μƒνƒ(State) μ •μ** 
  1. μ² ν•™μμ μƒνƒλ” THINKING, HUNGRY, EATINGμΌλ΅ μ •μν•λ©°, Javaμ enum νƒ€μ…μΌλ΅ μ„ μ–Έν•λ‹¤. 

2. **λ©”μΈ ν΄λμ¤: DiningPhilosophers** 
  1. DiningPhilosophers ν΄λμ¤μ main ν•¨μμ—μ„ 5λ…μ μ² ν•™μ(Philosopher) κ°μ²΄λ¥Ό λ°°μ—΄λ΅ μƒμ„±ν•λ‹¤. 
  2. DiningPhilosophersMonitorλ” λ¬Έμ  ν•΄κ²°μ„ μ„ν• **λ¨λ‹ν„°(Monitor)** μ—­ν• μ„ ν•λ©°, 5κ°μ κ°μ²΄λ¥Ό μƒμ„±μμ— λ„κ²¨μ£Όμ–΄ μ΄κΈ°ν™”ν•λ‹¤. 
  3. κ° μ² ν•™μ IDμ— ν•΄λ‹Ήν•λ” μ¤λ λ“λ¥Ό μƒμ„±ν•κ³  start() λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬ μ‹¤ν–‰ν•λ‹¤. 

3. **μ² ν•™μ μ¤λ λ“ ν΄λμ¤: Philosopher** 
  1. Philosopher ν΄λμ¤λ” Runnable μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•λ‹¤. 
  2. run() λ©”μ„λ“ λ‚΄μ—μ„ while(true) λ£¨ν”„λ¥Ό ν†µν•΄ μ² ν•™μκ°€ **μƒκ°ν•κ³ (thinking)**, **μ “κ°€λ½μ„ λ“¤κ³ (pickup)**, **μ‹μ‚¬ν•κ³ (eating)**, **μ “κ°€λ½μ„ λ‚΄λ ¤λ†“λ”(putdown)** κ³Όμ •μ„ λ¬΄ν•ν λ°λ³µν•λ‹¤. 
  3. μ “κ°€λ½μ„ λ“¤κ³  λ‚΄λ ¤λ†“λ” κ³Όμ •μ€ DiningPhilosophersMonitor ν΄λμ¤μ pickup()κ³Ό putdown() λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬ μ²λ¦¬ν•λ‹¤. 
  4. μƒμ„±μμ—μ„λ” μ² ν•™μμ idμ™€ λ™κΈ°ν™” λ¨λ‹ν„°μΈ DiningPhilosophersMonitor κ°μ²΄λ¥Ό νλΌλ―Έν„°λ΅ λ°›μ•„ λ©¤λ²„ λ³€μμ— μ €μ¥ν•λ‹¤. 
  5. **μƒκ°ν•λ” μ‹κ°„**: System.out.printlnμΌλ΅ "I'm thinking" λ©”μ‹μ§€λ¥Ό μ¶λ ¥ν•κ³ , <mark>0.05μ΄μ—μ„ 0.10μ΄</mark> μ‚¬μ΄μ λλ¤ν• μ‹κ°„ λ™μ• Thread.sleep()μ„ νΈμ¶ν•μ—¬ λ€κΈ°ν•λ‹¤. 
  6. **μ‹μ‚¬ν•λ” μ‹κ°„**: μƒκ°ν•λ” μ‹κ°„λ³΄λ‹¤ μ§§κ² μ„¤μ •ν•μ—¬, μƒκ°μ€ μ¤λ ν•κ³  λ°¥μ€ μ΅°κΈλ§ λ¨Ήλ„λ΅ ν•λ‹¤. 


## 4. λ¨λ‹ν„° κµ¬ν„: DiningPhilosophersMonitor 
![image]()
1. **λ¨λ‹ν„°μ μƒνƒ λ° λ³€μ μ„ μ–Έ** 
  1. μ² ν•™μμ μƒνƒλ¥Ό μ €μ¥ν•λ” state λ°°μ—΄ (enum State νƒ€μ…)μ„ μ„ μ–Έν•λ‹¤. 
  2. κ° μ² ν•™μλ§λ‹¤ ν•λ‚μ Condition λ³€μλ¥Ό μ κ³µν•λ” self λ°°μ—΄μ„ μ„ μ–Έν•λ‹¤. 
  3. ReentrantLock νƒ€μ…μ lock κ°μ²΄λ¥Ό μ„ μ–Έν•κ³ , Condition λ³€μλ“¤μ„ lock.newCondition()μ„ ν†µν•΄ μƒμ„±ν•μ—¬ self λ°°μ—΄μ— μ €μ¥ν•λ‹¤. 
  4. μ΄κΈ° μƒνƒλ” λ¨λ“  μ² ν•™μκ°€ THINKING μƒνƒλ΅ μ„¤μ •λλ‹¤. 

2. **μ “κ°€λ½ μ„μΉ μ •μ** 
  1. leftOf(i) ν•¨μλ” (i + numPhilosophers - 1) % numPhilosophersλ΅ μ™Όμ½ μ “κ°€λ½μ„, rightOf(i) ν•¨μλ” (i + 1) % numPhilosophersλ΅ μ¤λ¥Έμ½ μ “κ°€λ½μ„ μ§€μ •ν•λ‹¤. 

3. **μ “κ°€λ½ νλ“ λ΅μ§: pickup() λ©”μ„λ“** 
  1. pickup() λ©”μ„λ“ μ§„μ… μ‹ lock.lock()μ„ νΈμ¶ν•μ—¬ λ½μ„ νλ“ν•λ‹¤. 
  2. try-finally λΈ”λ΅μ„ μ‚¬μ©ν•μ—¬ μμ™Έ λ°μƒ μ—¬λ¶€μ™€ κ΄€κ³„μ—†μ΄ lock.unlock()μ΄ νΈμ¶λλ„λ΅ λ³΄μ¥ν•λ‹¤. 
  3. **λ‚΄λ¶€ λ΅μ§**:
  1. ν„μ¬ μ² ν•™μμ μƒνƒλ¥Ό HUNGRYλ΅ λ³€κ²½ν•λ‹¤. 
  2. test(id) λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬ μ “κ°€λ½μ„ νλ“ν•  μ μλ”μ§€ ν™•μΈν•λ‹¤. 
  3. λ§μ•½ μ “κ°€λ½μ„ νλ“ν•  μ μ—†λ” μƒνƒ(state[id]κ°€ EATINGμ΄ μ•„λ‹ μƒνƒ)λΌλ©΄, self[id].await()λ¥Ό νΈμ¶ν•μ—¬ λ€κΈ°ν•λ‹¤. 

4. **μ “κ°€λ½ λ°λ‚© λ΅μ§: putdown() λ©”μ„λ“** 
  1. putdown() λ©”μ„λ“ μ§„μ… μ‹ lock.lock()μ„ νΈμ¶ν•μ—¬ λ½μ„ νλ“ν•κ³ , finally λΈ”λ΅μ—μ„ lock.unlock()μ„ νΈμ¶ν•λ‹¤. 
  2. **λ‚΄λ¶€ λ΅μ§**:
  1. ν„μ¬ μ² ν•™μμ μƒνƒλ¥Ό THINKINGμΌλ΅ λ³€κ²½ν•λ‹¤. 
  2. μ™Όμ½ μ² ν•™μμ™€ μ¤λ¥Έμ½ μ² ν•™μμ— λ€ν•΄ test() λ©”μ„λ“λ¥Ό νΈμ¶ν•μ—¬, μ΄λ“¤μ΄ μ “κ°€λ½μ„ νλ“ν•  μ μλ”μ§€ ν™•μΈν•κ³  ν•„μ”ν• κ²½μ° signal()μ„ λ³΄λ‚Έλ‹¤. 

5. **μ “κ°€λ½ νλ“ κ°€λ¥ μ—¬λ¶€ ν™•μΈ: test() λ©”μ„λ“** 
  1. test(id) λ©”μ„λ“λ” ν„μ¬ μ² ν•™μ(id)κ°€ HUNGRY μƒνƒμ΄κ³ , μ™Όμ½ μ² ν•™μ(leftOf(id))μ™€ μ¤λ¥Έμ½ μ² ν•™μ(rightOf(id))κ°€ λ¨λ‘ EATING μƒνƒκ°€ μ•„λ‹ λ•λ§ μ “κ°€λ½μ„ νλ“ν•  μ μλ‹¤κ³  νλ‹¨ν•λ‹¤. 
  2. μ΅°κ±΄μ΄ μ¶©μ΅±λλ©΄ ν„μ¬ μ² ν•™μμ μƒνƒλ¥Ό EATINGμΌλ΅ λ³€κ²½ν•κ³ , self[id].signal()μ„ νΈμ¶ν•μ—¬ λ€κΈ° μ¤‘μΈ ν•΄λ‹Ή μ² ν•™μ μ¤λ λ“λ¥Ό κΉ¨μ΄λ‹¤. 

6. **Condition λ³€μμ **await()μ™€ signal() 
  1. Javaμ Condition λ³€μλ” C++μ wait()μ™€ notify() λ€μ‹  await()μ™€ signal() λ©”μ„λ“λ¥Ό μ‚¬μ©ν•λ‹¤. 
  2. μ΄ λ‘ λ©”μ„λ“λ” μ¤λ λ“ λ¨λ‹ν„° λ½(synchronized λΈ”λ΅)μ—μ„ μ‚¬μ©ν•λ” wait()μ™€ notify()μ™€ μ©λ„λ” λΉ„μ·ν•μ§€λ§, ReentrantLockκ³Ό ν•¨κ» μ‚¬μ©λλ” Condition λ³€μμ—μ„ μ‚¬μ©λλ‹¤λ” μ°¨μ΄μ μ΄ μλ‹¤. 


## 5. κ°•μ μλ£ μ¤λ¥ λ° λ³΄μ¶© μ•λ‚΄ 
![image]()
1. κ°•μ μλ£μ— μ¤λ¥κ°€ μμ–΄, μμƒκ³Ό ν•¨κ» λ³΄μ¶© μλ£λ¥Ό μ κ³µν•  μμ •μ΄λ‹¤. 

